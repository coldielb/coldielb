<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/vite.svg" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>frgmt blog</title>
        
        <!-- Connection preloading for faster initial load -->
        <link rel="preconnect" href="https://blog.frgmt.xyz" crossorigin />
        
        <!-- Web App Manifest -->
        <link rel="manifest" href="/manifest.json" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <meta name="apple-mobile-web-app-title" content="frgmt blog" />
        <link rel="apple-touch-icon" href="/logo.svg" />
        
        <!-- Preload critical resources -->
        <link rel="preload" href="/fonts/text/exo.otf" as="font" type="font/otf" crossorigin />
        <link rel="preload" href="/logo.svg" as="image" type="image/svg+xml" />
        <link rel="preload" href="/images/background.jpg" as="image" fetchpriority="high" />
        <link rel="modulepreload" href="/src/main.jsx" />
        <link rel="modulepreload" href="/src/App.jsx" />
        
        <!-- Resource hints -->
        <link rel="dns-prefetch" href="https://static.cloudflareinsights.com" />
        <link rel="preconnect" href="https://static.cloudflareinsights.com" crossorigin />
        
        <!-- Meta tags for better SEO and sharing -->
        <meta name="description" content="Thoughts on technology, programming, and more" />
        <meta name="theme-color" content="#1A1A1A" />
        
        <!-- Add inline critical CSS to prevent render blocking -->
        <style>
            /* Critical CSS for initial render */
            body {
                margin: 0;
                padding: 0;
                background: #1a1a1a;
                color: #333;
                font-family: sans-serif; /* Fallback font */
            }
            .page-background {
                min-height: 100vh;
                background-image: url("/images/background.jpg");
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
            }
            @font-face {
                font-family: "Borela";
                src: url("/fonts/text/exo.otf") format("opentype");
                font-display: swap;
                font-weight: normal;
                font-style: normal;
            }
            #root {
                display: flex;
                flex-direction: column;
                min-height: 100vh;
            }
            .app-loading {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                background: #1a1a1a;
                color: #f5f5f5;
                font-family: sans-serif;
            }
        </style>
    </head>
    <body>
        <div id="root">
            <!-- Initial loading state to show before JS loads -->
            <div class="app-loading">
                <div style="text-align: center">
                    <h2>Loading frgmt blog...</h2>
                    <p>Just a moment while we prepare your experience</p>
                </div>
            </div>
        </div>
        
        <!-- Inline script to measure and log page load time -->
        <script>
            // Record the start time
            window.pageLoadStart = Date.now();
            
            // Listen for when the page is fully loaded
            window.addEventListener('load', () => {
                const loadTime = Date.now() - window.pageLoadStart;
                console.log(`Page fully loaded in ${loadTime}ms`);
                
                // Send the load time to analytics if needed
                if (navigator.sendBeacon) {
                    const data = new FormData();
                    data.append('loadTime', loadTime);
                    navigator.sendBeacon('/api/analytics/pageload', data);
                }
            });
        </script>
        
        <script type="module" src="/src/main.jsx"></script>
        
        <!-- Service Worker Registration -->
        <script>
            if ('serviceWorker' in navigator) {
                // Register service worker as soon as possible
                navigator.serviceWorker.register('/sw.js', { scope: '/' })
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            }
        </script>
        
        <!-- Cloudflare Web Analytics - Load after critical content -->
        <script
            defer
            src="https://static.cloudflareinsights.com/beacon.min.js"
            data-cf-beacon='{"token": "2b74062d050b43069681bf7cca3307e3"}'
        ></script>
        <!-- End Cloudflare Web Analytics -->
    </body>
</html>
